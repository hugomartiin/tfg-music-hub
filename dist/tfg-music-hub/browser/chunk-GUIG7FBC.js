import{e as D,f as F}from"./chunk-DVA2DFGU.js";import{$ as p,$a as w,Aa as a,Ea as v,Ja as k,Ma as _,Sb as T,Ta as m,Tb as V,Vb as I,Ya as n,Za as r,_a as C,aa as d,ab as E,bb as g,cb as y,db as f,e as u,lb as x,mb as o,nb as h,ob as S,pb as M,vc as z,xc as O,y as b,zb as P}from"./chunk-OXW2PTIW.js";function q(l,t){if(l&1){let e=g();n(0,"div",14),y("click",function(){let s=p(e).$implicit,c=f(2);return d(c.selectPlaylist(s))}),n(1,"button",15),y("click",function(s){let c=p(e).$implicit,A=f(2);return d(A.deletePlaylist(c,s))}),o(2," \u2715 "),r(),n(3,"div")(4,"h3",16),o(5),r(),n(6,"p",17),o(7),r()()()}if(l&2){let e=t.$implicit;a(5),h(e.name),a(2),M(" ",e.tracks.length," canci\xF3n",e.tracks.length!==1?"es":""," ")}}function N(l,t){if(l&1&&(w(0),n(1,"div",12),_(2,q,8,3,"div",13),r(),E()),l&2){let e=f();a(2),m("ngForOf",e.playlists)}}function j(l,t){l&1&&(n(0,"p",18),o(1,"A\xFAn no tienes playlists guardadas."),r())}function Q(l,t){if(l&1){let e=g();n(0,"div",24)(1,"button",25),y("click",function(){let s=p(e).index,c=f(3);return d(c.removeTrackFromPlaylist(s))}),o(2," \u2715 "),r(),C(3,"app-track-card",26),r()}if(l&2){let e=t.$implicit;a(3),m("track",e)}}function R(l,t){if(l&1&&(n(0,"div",22),_(1,Q,4,1,"div",23),r()),l&2){let e=f(2);a(),m("ngForOf",e.trackDetails)}}function Y(l,t){l&1&&(n(0,"p",27),o(1,"Esta playlist no tiene canciones."),r())}function B(l,t){if(l&1&&(n(0,"div",19)(1,"h3",20),o(2),r(),_(3,R,2,1,"div",21)(4,Y,2,0,"ng-template",null,1,P),r()),l&2){let e=x(5),i=f();a(2),S(" Playlist: ",i.selectedPlaylist.name," "),a(),m("ngIf",i.trackDetails.length)("ngIfElse",e)}}var $=class l{constructor(t,e){this.playlistService=t;this.deezerService=e}playlists=[];selectedPlaylist=null;trackDetails=[];ngOnInit(){this.playlistService.getPlaylists$().subscribe({next:t=>{this.playlists=t,this.selectedPlaylist&&!t.find(e=>e.id===this.selectedPlaylist?.id)&&(this.selectedPlaylist=null,this.trackDetails=[])},error:t=>{console.error("Error al cargar playlists:",t)}})}selectPlaylist(t){if(this.selectedPlaylist=t,!t.tracks.length){this.trackDetails=[];return}let e=t.tracks.map(i=>this.deezerService.getTrack(+i));b(e).subscribe({next:i=>{this.trackDetails=i},error:i=>{console.error("Error cargando tracks de la playlist:",i),this.trackDetails=[]}})}deletePlaylist(t,e){e.stopPropagation(),this.openConfirmModal(`\xBFSeguro que quieres borrar la playlist "${t.name}"?`,()=>u(this,null,function*(){try{if(!t.id)throw new Error("Playlist sin id");yield this.playlistService.deletePlaylist(t.id),this.selectedPlaylist?.id===t.id&&(this.selectedPlaylist=null,this.trackDetails=[])}catch(i){console.error("Error borrando playlist:",i),alert("Error al borrar playlist.")}}))}removeTrackFromPlaylist(t){if(!this.selectedPlaylist)return;let e=this.trackDetails[t];this.openConfirmModal(`\xBFQuieres quitar la canci\xF3n "${e.title}" de la playlist "${this.selectedPlaylist.name}"?`,()=>u(this,null,function*(){try{let i=[...this.selectedPlaylist.tracks];i.splice(t,1),yield this.playlistService.updatePlaylist(this.selectedPlaylist.id,{tracks:i}),this.selectedPlaylist.tracks=i,this.trackDetails.splice(t,1)}catch(i){console.error("Error quitando canci\xF3n:",i),alert("Error al quitar canci\xF3n de la playlist.")}}))}confirmModalVisible=!1;confirmModalMessage="";confirmModalAction=null;openConfirmModal(t,e){this.confirmModalMessage=t,this.confirmModalAction=e,this.confirmModalVisible=!0}confirmModalYes(){return u(this,null,function*(){this.confirmModalAction&&(yield this.confirmModalAction()),this.confirmModalVisible=!1})}cancelModal(){this.confirmModalVisible=!1}static \u0275fac=function(e){return new(e||l)(v(z),v(D))};static \u0275cmp=k({type:l,selectors:[["app-playlist"]],decls:16,vars:5,consts:[["noPlaylists",""],["noTracks",""],[1,"min-h-screen","text-white"],[1,"max-w-7xl","mx-auto"],[1,"text-4xl","font-extrabold","mb-8","border-b","border-gray-700","pb-2"],[4,"ngIf","ngIfElse"],["class","mt-12 max-w-4xl mx-auto",4,"ngIf"],[3,"close","visible"],[1,"text-white","text-lg","mb-6","text-center"],[1,"flex","justify-center","gap-6"],["type","button",1,"bg-gray-700","hover:bg-gray-600","text-gray-300","font-semibold","rounded-lg","px-6","py-2","shadow","transition",3,"click"],["type","button",1,"bg-red-600","hover:bg-red-700","text-white","font-semibold","rounded-lg","px-6","py-2","shadow","transition",3,"click"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white/10 rounded-xl p-4 flex flex-col gap-4 hover:shadow-lg transition-transform duration-300 hover:scale-[1.02] relative group",3,"click",4,"ngFor","ngForOf"],[1,"bg-white/10","rounded-xl","p-4","flex","flex-col","gap-4","hover:shadow-lg","transition-transform","duration-300","hover:scale-[1.02]","relative","group",3,"click"],["title","Eliminar playlist","type","button",1,"absolute","top-3","right-3","text-gray-400","hover:text-red-500","transition-colors","z-10",3,"click"],[1,"text-xl","font-semibold","truncate"],[1,"text-sm","text-gray-400","mt-1"],[1,"text-center","text-gray-400","italic","py-12"],[1,"mt-12","max-w-4xl","mx-auto"],[1,"text-3xl","font-bold","mb-6","border-b","border-gray-700","pb-2"],["class","max-h-[410px] overflow-y space-y-4",4,"ngIf","ngIfElse"],[1,"max-h-[410px]","overflow-y","space-y-4"],["class","relative group",4,"ngFor","ngForOf"],[1,"relative","group"],["title","Quitar canci\xF3n de la playlist","type","button",1,"absolute","top-3","right-3","z-10","hover:text-red-500","transition-all","duration-300","opacity-0","group-hover:opacity-100","translate-y-[-4px]","group-hover:translate-y-0","p-1",3,"click"],[3,"track"],[1,"text-gray-500","italic","text-center","py-6"]],template:function(e,i){if(e&1){let s=g();n(0,"div",2)(1,"div",3)(2,"h2",4),o(3,"Tus Playlists"),r(),_(4,N,3,1,"ng-container",5)(5,j,2,0,"ng-template",null,0,P)(7,B,6,3,"div",6),n(8,"app-modal",7),y("close",function(){return p(s),d(i.cancelModal())}),n(9,"p",8),o(10),r(),n(11,"div",9)(12,"button",10),y("click",function(){return p(s),d(i.cancelModal())}),o(13," Cancelar "),r(),n(14,"button",11),y("click",function(){return p(s),d(i.confirmModalYes())}),o(15," Confirmar "),r()()()()()}if(e&2){let s=x(6);a(4),m("ngIf",i.playlists.length)("ngIfElse",s),a(3),m("ngIf",i.selectedPlaylist),a(),m("visible",i.confirmModalVisible),a(2),h(i.confirmModalMessage)}},dependencies:[I,T,V,F,O],encapsulation:2})};export{$ as PlaylistsComponent};
